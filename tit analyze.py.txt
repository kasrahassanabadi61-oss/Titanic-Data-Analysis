# Titanic Data Analysis Project
# Author: Kasra Hassanbadi
# Purpose: Data analysis to investigate survival patterns in the Titanic disaster

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import LabelEncoder

data = pd.read_csv(r'C:\Users\Lenovo\Downloads\titanic.csv')
print("Data Loaded Successfully!\n")

print("First 5 rows:")
print(data.head(), "\n")

print("Data Info:")
print(data.info(), "\n")

print("Data Description:")
print(data.describe(), "\n")

print("Missing Values:")
print(data.isnull().sum(), "\n")

data['Age'].fillna(data['Age'].mean(), inplace=True)
data['Cabin'].fillna('Unknown', inplace=True)
data.dropna(subset=['Embarked'], inplace=True)

print("Missing values handled.\n")

plt.figure(figsize=(6,4))
sns.countplot(x='Survived', data=data, palette='coolwarm')
plt.title("Survival Count (0=No, 1=Yes)")
plt.show()

plt.figure(figsize=(6,4))
sns.countplot(x='Sex', hue='Survived', data=data, palette='Set2')
plt.title("Survival by Gender")
plt.show()

plt.figure(figsize=(6,4))
sns.countplot(x='Pclass', hue='Survived', data=data, palette='Set3')
plt.title("Survival by Passenger Class")
plt.show()

plt.figure(figsize=(6,4))
sns.histplot(data=data, x='Age', hue='Survived', multiple='stack', bins=30)
plt.title("Age Distribution by Survival")
plt.show()

print("Average Age by Survival:")
print(data.groupby('Survived')['Age'].mean(), "\n")

print("Survival Rate by Gender:")
print(data.groupby('Sex')['Survived'].mean(), "\n")

print("Survival Rate by Passenger Class:")
print(data.groupby('Pclass')['Survived'].mean(), "\n")

features = ['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare']
X = data[features]
y = data['Survived']

X['Sex'] = LabelEncoder().fit_transform(X['Sex'])

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

model = LogisticRegression(max_iter=200)
model.fit(X_train, y_train)

accuracy = model.score(X_test, y_test)
print(f"Model Accuracy: {accuracy:.2%}\n")

pred = model.predict(X_test[:5])
print("Sample Predictions:", pred)
print("Real Values:", list(y_test[:5]), "\n")

print("Final Analysis:")
print("""
1) Women were much more likely to survive than men.
2) First class passengers had the best chance of survival.
3) Younger ages (children and adolescents) had higher survival rates.
4) Our simple model achieved about 78% accuracy.
""")

print("Project Completed Successfully!")

